## 3.1 基础知识

###3.1.1  IP地址的概念及划分地址新技术的研究

####一、IP地址的概念
    
    IP地址是32位的二进制数值，通常用点分十进制来表示。即IP地址有两种变现形式：二进制和点分十进制。
    每个IP地址又可分为两部分，即网络号部分和主机号部分：网络号表示其所属的网络段编号，主机号则表示该网段中该主机的地址编号。
    按照网络规模的大小，IP地址又可分为A、B、C、D、E五类，其中A、B、C类地址是三种主要的类型地址。D类地址是专供多目传送用的多目地址，E类地址用于扩展备用地址。

#### 二、IPv4划分技术的发展
    
    IP地址划分技术的研究历程大致可以分为四个阶段。
    
    （1）     第一阶段是标准分类的IP地址
        IPv4协议的初期，大约在1981年左右。IP地址采用“网络号—主机号”的两级的层次结构。常用的是A类、B类、C类地址。网络规模小，IP地址利用率低。
        
    （2）     第二阶段：划分子网的三级地址结构
        始于1991年。为提高地址利用率，提出了子网Subnet和掩码mask的概念。即将一个大的网络划分为几个较小的子网络，地址结构变为“网络号—子网号—主机号”的三级结构。
        
    （3）     构成超网的无类域间路由(CIDR)技术
        始于1993年。无类域间路由(CIDR)技术是为了解决Internet中存在的地址枯竭及路由负担增大的问题。
        
    （4）     网络地址转换(NAT)技术
        始于1996年，源于ISP接入中节约IP地址的需要。NAT设计的基本思路是：为每一个公司分配一个或少量的IP地址，用于传输Internet的流量。在公司内部的每台主机分配一个不能够在Internet上使用的保留的专用IP地址。
    
#### 三、下一代IPv6地址
    
    IPv6采用128位地址长度，几乎可以不受限制的提供地址。
    同IPv4相比，IPv6的优点如下：新的协议格式、巨大的地址空间、有效地分级寻址和路由结构、地址自动分配、内部安全机制、要好支持QoS服务。
    IPv6地址分类：单播地址、广播地址、多播地址和特殊地址等基本的四类。
    IPv6地址表示方法：冒号十六进制。
 
### 3.1.2 标准分类的IP地址
#### 一、           A类地址
    A类地址网络号(net ID)的第一位为0，其余的7位可以分配。因此A类地址分为大小相同的128(27=128)块，每一块的net ID不同。    
    第一块覆盖的地址为：0.0.0.0~0.255.255.255（net ID=0）
    第二块覆盖的地址为：1.0.0.0~1.255.255.255（net ID=1）
    ……
    最后一块覆盖的地址为：127.0.0.0~127.255.255.255（net ID=127）
    但是，第一块和最后一块地址留作特殊用途，127.x.x.x已经被保留作为回路测试使用，网络0.0.0.0也保留用于广播地址（未知网络）。另外net ID=10的10.0.0.0~10.255.255.255用于专用地址，其余的125块可以指派给一些机构。因此能得到A类地址的机构只有125个。每一个A类网络可以分配的主机号host ID可以是224-2=1677214个，主机号全为0和全为1的两个地址保留用于特殊用途。主机号全为0和表示网络，全为1的主机地址表示到这个网络的定向广播。
####二、           B类地址
    B类地址的网络号(net ID)长度为14位，网络号的前两位固定设置为10。
####三、C类地址
    C类地址的网络号(net ID)长度为21位，网络号的前三位被固定设置为110。
####四、           D类地址
    D类地址用于IP网络中的组播（多点广播），它不像A、B、C类地址一样拥有网络号和主机号。一个组播地址表示了一个IP地址组。因此可以同时把一个数据流发送到多个接收端，这要比为每个接收端创建一个数据流的流量小得多，它可以有效地节省网络带宽。
    D类地址以110开头，没有子网掩码。
####五、           E类地址
    E类地址被Internet工程任务组(Internet Engineering Task Force, IETE)保留做研究使用，以111开头。
    综上，各类地址的范围如下：
    A类地址：1.0.0.0~126.255.255.255（0和127网段保留作为特殊用途）
    
B类地址：128.0.0.0~191.255.255.255

C类地址：192.0.0.0~223.255.255.255

D类地址：224.0.0.0~239.255.255.255

E类地址：240.0.0.0~255.255.255.255

####六、           特殊地址形式

特殊的IP地址包括：直接广播(directed broadcasting)地址、受限广播(limited broadcasting)地址、“这个网络上的特定主机”地址与回送地址(loopback address)。
1. 直接广播地址

        A、B、C类地址中主机号全为1的地址。用来使路由器将一个分组以广播方式发送给特定网络上的主机。
2. 受限广播地址

    32位全为1的IP地址（255.255.255.255）。用来将一个分组以广播方式发送给本网络中的所有主机。路由器则阻挡该分组通过，将其广播功能限制在本网内部。
    
3. “这个网络上特定主机”地址
    
        其网络号的位全为0，主机号为确定的值；作用是由主机或路由器向本网络上的某个特定的主机发送分组时，分组被限制在本网络内部。
        
4. 回送地址

        A类IP地址中的127.0.0.0；用于网络软件测试和本地进程间通信。“Ping”应用程序可以发送一个将回送地址作为目的地址的分组，以测试IP软件能否接受和发送一个分组，一个客户进程可以使用回送地址来发送一个分组给本机的另一个进程，用来测试本地进程间的通信情况。
        
### 3.1.3 划分子网的三级地址结构
####一、           子网的基本概念
    子网概念的基本思想：允许将网络划分成多个部分供网络内部使用，但是对于外部网络仍然像一个网络一样。
####二、划分子网的地址结构

划分子网的技术要点是：

    （1）三级层次的IP地址：net ID-Subnet ID-host ID；
    （2） 同一个子网中所有的主机必须使用相同的子网号Subnet ID；
    （3）子网的概念可以应用于A类、B类或C类中任意一类的IP地址中；
    （4）子网自检的距离必须很近；
    （5）分配子网是一个组织和单位内部的事情，它既不要向IDANN申请，也不需改变任何外部的数据库。
    （6）在Internet的文献中，一个子网也称作一个IP网络或一个网络。
####三、           子网掩码的概念

    子网掩码(subnet mask)：也叫做网屏蔽码，主要功能是向网络设备说明，一个特定IP地址的那一部分包含网络地址与子网地址，哪一部分是主机地址。
 
###3.1.4 无类域间路由(CIDR)技术

- 无类域间路由

    (classless inter domain routing, CIDR)于1933年提出，这是一种解决IP地址耗尽及路由表增大而提出的一种措施。
研究思路：将剩余的IP地址不是按标准的地址分类规则分配，而是以可变大小的块方法进行分配。

    无类域间路由技术也称为超网技术。超网是将现有的网络地址合并成较大的、具有更多主机地址的路由域，从而可以减轻路由负担。
    
    表示方法：CIDR采用新的无分类的二级地址结构，表示为<网络前缀>，<主机号>（区别于标准IP地址的“网络号+主机号”）。用“斜线记法”表示。即在IP地址后面加一个斜线“/”，然后写上网络前缀所占的比特数。
广播地址：主机号全为1的地址。
 
### 3.1.5 专用IP地址与内部网络地址规划方法
#### 一、全部IP地址与专用IP地址

全局IP地址与专用IP地址的区别主要表现在以下几个方面：

    （1）全局IP地址是分组在Internet上传输时使用的IP地址。专用IP地址只能适用于一个机构、一个公司内部的网络，不能直接用于Internet上。
    （2）使用全局IP地址需要向IANA机构申请，使用专用IP地址不需要。
    （3）全局IP地址必须保证在Internet上是唯一的；专用IP地址在某一个网络内部是唯一的，但在整个Internet中并不是唯一的。
    IPv4为内部网络预留的专用IP地址有三组，分别是：
    A类：10.0.0.0~10.255.255.255；
    B类：172.16.0.0~172.31.255.255.255；
    C类：192.168.0.0~192.168.255.255。
    
####二、NAT方法的局限性

NAT方法引起的一些问题主要包括以下几点：
    
    （1）NAT违反IP地址结构模型的设计原则。
    （2）NAT使得IP协议从面向无连接变成了面向连接。
    （3）NAT违反的基本的网络分层结构模型的设计原则。
    （4）NAT同时存在对高层协议和安全性的影响问题。
 
## 1.2实训任务
###1.2.1实训任务一：IP地址规划方法
####一、IP地址规划的基本步骤

网络地址规划需按以下6步进行：

    （1）     判断用户对网络与主机数的需求；
    （2）     计算满足用户需求的基本网络地址结构；
    （3）     计算地址掩码；
    （4）     计算网络地址；
    （5）     计算网络广播地址；
    （6）     计算网络的主机地址。
####二、地址规划的基本方法
1.步骤一：判断网络与主机数量的需求
根据网络总体设计中物理拓扑设计的参数，确定以下两个主要数据：

    （1）     网络中最多可能使用的子网数量Nnet；
    （2）     网络中最大网段已有和可能扩展的主机数量Nhost；

2.步骤二：计算满足用户需求的基本网络地址结构

    （1）     选择subnet ID字段的长度值X，要求Nnet≤2X。
    （2）     选择host ID字段的长度值Y，要求Nhost≤2Y。
    （3）     根据X+Y的值可以确定需要申请哪一类IP地址。

3.步骤三：计算地址掩码

    划分子网后的地址掩码是将一个标准的32位IP地址中高于host ID（Y位以上）的高位置1即可。

4.步骤四：计算网络地址

    相邻子网的增长量为2Y。
    需要注意的是，最初在描述在划分子网的RFC文档中规定不是用第一个和最后一个网络地址。

5.步骤五：计算网络广播地址
    
    一个子网的定向广播地址是比下一个子网地址号小1的地址。

6.步骤六：计算网络的主机地址

    除了网络地址与广播地址之外的地址都是主机可用的IP地址。
 
###1.2.2                    实训任务二：子网的地址规划方法

子网地址规划需要回答以下5个基本问题：

    1这个被选定的子网掩码可以产生多少子网？（2x-2，x代表掩码的位数）
    2每个子网内部有多少合法的主机ID？（主机号位数为y位的网络合法主机地址为2y-2个）
    3这些合法的主机地址是什么？
    4每个子网内部的广播地址是什么？（广播地址=下一个子网号-1）
    5每个子网内部合法的net ID是什么？
 
###1.2.3                    实训任务三：可变长度子网掩码(VLSM)地址规划方法
    可变长度子网掩码(VLSM)地址规划的基本原则
    IP协议允许使用变长子网的划分(RFC1009)。在某种情况下，需要在子网划分时可以设计子网号长度是不同的。
    可变长度子网掩码(variable length subnet masks, VLSM)是在标准呗掩码上面再划分子网的网络号码，在一个主类（A、B、C类）网络内包含多个子网掩码。
 
###1.2.4                    实训任务四：CIDR地址规划方法
    
    CIDR地址的一个重要特点：地址聚合(address aggregation)和路由聚合(route aggregation)。
 
###1.2.5实训任务五：内部网络专用IP地址规划与网络地址转换NAT方法

一、规划内部网络地址系统的基本原则

    使用专用地址来规划内部网络地址系统时需要遵循的基本原则：
    
    简洁；便于系统的扩展与管理；有效的路由。

二、NAT的基本概念

    网络地址转换(NAT)技术是在公网地址与私有IP地址之间转换的技术，在网络内部使用专用IP地址，连接到Internet的时候使用公用IP地址。网络地址转换(NAT)技术适用于四类应用领域，一是ISP、ADSL与有线电视的地址分配；二是移动无线接入地址分配；三是电子政务内网等对Internet访问需要严格控制的内部网络系统的地址分配；四是与防火墙相结合。

    NAT可以分为“一对一”和“多对多”，前者又称为静态NAT，后者又称为动态NAT。
 
###1.2.6                    实训任务六：IPv6地址规划基本方法

一、IPv6地址的主要特征

    IPv6的主要特征可以总结为：新的协议格式、巨大的地址空间、有效地分级寻址和路由结构、地址自动分配、内部安全机制、要好支持QoS服务。

    IPv6长度规定为128位，因此它可以提供超过3.4×1038个IP地址。IPv6地址空间是IPv4的296倍。

二、IPv6地址分类

    IPv6地址分为：单播地址、组播地址、多播地址与特殊地址等基本的四类。

三、            IPv6地址表示方法

    IPv6的128位地址按每16位划分为一个网段，每个位段都被转换为一个4位的十六进制数，并用“:”隔开，这种表示法称为冒号十六进制(colon hexadecimal)表示法。
    一个IPv6地址中可能会出现多个二进制数0，因此可以规定一种方法，通过压缩某个位段中的前导0来简化IPv6地址的表示。例如，“00D3”可以简写为“D3”；“02AA”可以简写为“2AA”。但是“FE08”就不可以简写为“FE8”。同时需要注意的是，每个位段至少应该有一个数字，“0000”可以简写为“0”。
    如果几个连续位段的值都为0，那么这些0就可以简写为“::”,称为双冒号表示法(double colon)。

四、IPv6地址表示需要注意的问题

在表示IPv6地址时，需要注意以下几个问题：

    （1）在使用零压缩法时，不能把一个位段内部的有效0也压缩掉。
    （2） ::双冒号在一个地址中这能出现一次。
    （3）IPv6不支持子网掩码，它只支持前缀长度表示法。前缀是IPv6地址的一部分，用作IPv6路由或子网标识。IPv6前缀可以用“地址/前缀长度“来表示。
 
 
##1.3     个人整理

1. 几个常用的命令

（1）Ping
    
    这个命令用来检测一桢数据从当前主机传输到目的主机所需要的时间。它还提供许多参数，如-t是主机不断地向目的主机发送数据，知道使用Ctrl+C中断；-n可以自己确定向目的主机发送的数据帧数，等等。
（2）Winipcfg

    这个命令用来显示主机内IP协议的配置信息。
（3）Tracert
    
    这个命令的功能是断定数据包到达目的主机所经过的路径、显示数据包经过的中继节点清单和到达时间。还可以使用参数-d决定是否解析主机名。
（4）Netstat

    这个命令有助于了解网络的整体使用情况。它可以显示当前正在活动的网络连接的详细信息、如采用的协议类型、当前主机与远端相连主机的IP地址以及它们之间的连接状态。

2.  DNS为客户提供存储、查询和搜索其它主机域名和IP地址的服务。主要实现域名和IP地址之间的转换，以解决IP地址难以记忆的问题。

3. 局域网上所有用户共享同一IP地址方式来访问Internet的两种解决方案

        （1）在服务器上安装代理服务器软件（例如Wingate），个PC机通过代理服务器访问Internet。
        （2）在服务器端启动Internet连接共享服务，各PC机共享服务器的Internet连接。
    
4. IP过滤技术可以讲访问者与被访问者限制在一个特定范围内，可通过以下两种方法实现：

    （1）由管理员分配IP分组过滤表，IP过滤模块根据IP分组中报头的源地址、目的地址、端口号等信息，对来往的IP分组进行过滤，允许或禁止某些IP地址分访问。
    （2）通过代理服务器来限制内部用户对Internet的访问。

5. 将IP地址转换为物理网络地址的协议是ARP。
6. 无类域的意思是指CIDR采用13~27位可变网络ID，而不是A、B、C类网络ID所用的固定的7、14和21位。